<!--  Jabber2 - jabberd JBOX configuration  -->
<jbox project='jabberd'>
  <build>
    <variables>
      <var name='DEFINES'><value>-DCONFIGXML="\"jabber.xml\"" -DHOME="\"$(JHOME)\""</value></var>
    </variables>
    <libraries>
      <library priority='required'>
        <name>pth</name>
        <version>
	  <needed>1.3.7</needed>
	  <command>pth-config --version</command>
        </version>
	<var name='CFLAGS'><command>pth-config --cflags</command></var>
	<var name='LDFLAGS'><command>pth-config --ldflags</command></var>
	<var name='LIBS'><command>pth-config --libs</command></var>
      </library>
    </libraries>
    <make>
      <project>base</project>
      <project>lib</project>
      <macro name='HEADERS'>
        <file>jabberd.h</file>
      </macro>
      <macro name='OBJECTS'>
        <file>config.o</file>
        <file>deliver.o</file>
        <file>heartbeat.o</file>
        <file>jabberd.o</file>
        <file>load.o</file>
        <file>log.o</file>
        <file>mio.o</file>
        <file>mio_raw.o</file>
        <file>mio_ssl.o</file>
        <file>mio_xml.o</file>
        <file>mtq.o</file>
        <file>static.o</file>
        <file>xdb.o</file>
      </macro>
      <macro name='EXOBJECTS'>
        <file>base/base_accept.o</file>
        <file>base/base_connect.o</file>
        <file>base/base_dynamic.o</file>
        <file>base/base_exec.o</file>
        <file>base/base_file.o</file>
        <file>base/base_format.o</file>
        <file>base/base_stderr.o</file>
        <file>base/base_stdout.o</file>
        <file>base/base_to.o</file>
        <file>lib/expat.o</file>
        <file>lib/genhash.o</file>
        <file>lib/hashtable.o</file>
        <file>lib/jid.o</file>
        <file>lib/jpacket.o</file>
        <file>lib/jutil.o</file>
        <file>lib/karma.o</file>
        <file>lib/pool.o</file>
        <file>lib/pproxy.o</file>
        <file>lib/rate.o</file>
        <file>lib/sha.o</file>
        <file>lib/snprintf.o</file>
        <file>lib/socket.o</file>
        <file>lib/str.o</file>
        <file>lib/xmlnode.o</file>
        <file>lib/xmlparse.o</file>
        <file>lib/xmlrole.o</file>
        <file>lib/xmltok.o</file>
        <file>lib/xstream.o</file>
      </macro>
      <macro name='STATICOBJECTS'>
        <file>../dnsrv/dnsrv.o</file>
        <file>../dnsrv/srv_resolv.o</file>
        <file>../dialback/dialback.o</file>
        <file>../dialback/dialback_in.o</file>
        <file>../dialback/dialback_out.o</file>
        <file>../jsm/authreg.o</file>
        <file>../jsm/deliver.o</file>
        <file>../jsm/jsm.o</file>
        <file>../jsm/modules.o</file>
        <file>../jsm/offline.o</file>
        <file>../jsm/server.o</file>
        <file>../jsm/sessions.o</file>
        <file>../jsm/users.o</file>
        <file>../jsm/util.o</file>
        <file>../jsm/modules/mod_admin.o</file>
        <file>../jsm/modules/mod_agents.o</file>
        <file>../jsm/modules/mod_announce.o</file>
        <file>../jsm/modules/mod_archive.o</file>
        <file>../jsm/modules/mod_auth_0k.o</file>
        <file>../jsm/modules/mod_auth_digest.o</file>
        <file>../jsm/modules/mod_auth_plain.o</file>
        <file>../jsm/modules/mod_browse.o</file>
        <file>../jsm/modules/mod_echo.o</file>
        <file>../jsm/modules/mod_filter.o</file>
        <file>../jsm/modules/mod_groups.o</file>
        <file>../jsm/modules/mod_last.o</file>
        <file>../jsm/modules/mod_log.o</file>
        <file>../jsm/modules/mod_offline.o</file>
        <file>../jsm/modules/mod_presence.o</file>
        <file>../jsm/modules/mod_register.o</file>
        <file>../jsm/modules/mod_roster.o</file>
        <file>../jsm/modules/mod_time.o</file>
        <file>../jsm/modules/mod_vcard.o</file>
        <file>../jsm/modules/mod_version.o</file>
        <file>../jsm/modules/mod_xml.o</file>
        <file>../pthsock/client.o</file>
        <file>../pthsock/dialback.o</file>
        <file>../xdb_file/xdb_file.o</file>
      </macro>
      <compile>
 	<objectfile macro='OBJECTS'>
	  <dep><macro>HEADERS</macro></dep>
        </objectfile>
        <binary name='jabberd' type='dynamic'>
          <dep filelist='1'>
            <macro>OBJECTS</macro>
            <macro>EXOBJECTS</macro>
          </dep>
        </binary>
        <binary name='jabberd' type='static'>
          <dep filelist='1'>
            <macro>OBJECTS</macro>
            <macro>EXOBJECTS</macro>
            <macro>STATICOBJECTS</macro>
          </dep>
        </binary>
        <binary name='jabberd' type='single'>
          <dep filelist='1'>
            <macro>OBJECTS</macro>
            <macro>EXOBJECTS</macro>
            <macro>STATICOBJECTS</macro>
          </dep>
        </binary>
      </compile>
    </make>
  </build>
</jbox>
